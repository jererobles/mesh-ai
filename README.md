# The New ~Bing~ Everything

A simple implementation of the ChatGPT API in an attempt to replicate the "new Bing" in an open source and (hopefully) extensible way.

Read the [blogpost here](https://blog.jererobles.me/b/6F9D6A3A-A8A7-4E47-8CDB-1FFD0C3A1D85/The-new-everything).

![Logo generated by DALL-E](https://user-images.githubusercontent.com/9132875/222984572-9630ebb7-aa22-4567-9345-8d789319be24.png)

Artwork by Dall-E with prompt `AI-powered search engine, abstract`

## Demo

https://user-images.githubusercontent.com/9132875/222984291-b5baa390-158f-4770-ae57-7d80b7f49df5.mp4

## Example interaction

Prompt

```
what is latest tesla stock price?
```

Answer

```
‚úÖ Topic: Financial market trends and updates.
üîç Searching the web for: Tesla stock price.
üîó Found 10 sources
üìñ Reading...
ü§ì Summarizing...
üí¨ As of the time of writing, Tesla's stock price on NASDAQ is 185.30 USD, which is a decrease of 2.41 USD or 1.28% from the previous close. The market capitalization of Tesla is 593.934B USD, with 33.16B shares outstanding. The EPS (TTM) is 3.62 USD USD, P/E (TTTTM) is 51.78, and Fwd P/E (NTM) is 47.35. The EBITDA (TTM) is 17.375B USD, and the revenue (TTM) is 81.462B USD.
```

## Usage

Set your OpenAI API Key in `.env`

```bash
git clone https://github.com/jererobles/mesh-ai.git
cd mesh-ai
echo "<your_key>" > .env
```

To install dependencies:

```bash
bun install
```

To run:

```bash
bun index.ts
```

## How it works

This section is a WIP.

### Agent

Just like no single human has the knowledge or is trained to do every task, it is unreasonable to expect one model with a fixed set of parameters to handle every user input.

An Agent is just an instance of GPT3.5 with a predefined set of parameters and more importantly, a conversation seed that defines the capabilities and personality of the agent. It is also possible, although optional, to pass a `transformer` function and a `validation` function. See [agents/types.ts](https://github.com/jererobles/mesh-ai/blob/main/agents/types.ts) for more information.

### API

Any backend system that the AI may decide to call. We avoid implementing too much website-specific parsing logic as these are prone to break over time ‚Äî instead we prefer to let the language model make sense of the context by translating it to something more amenable e.g. HTML -> Markdown.

### Model

Representing a model from OpenAI ‚Äî an API key is required to use it but this may change in the future if we decide to support offline usage. DaVinci and ChatGPT-3.5 are the ones implemented so far but only the latter is actually used.

## Caveats

- code needs more time than I can dedicate in a weekend meaning lots of parts need to be refactored
- although Agents support _some_ limited logic using the functions mentioned above, **the intention is to craft the seed messages in order to produce the desired output** ‚Äî with the one exception of the "final" response which may contain special keywords injected in the response that the stream parser can pick up on in order to decide if a web search is required
- sometimes the model's limitations leak through for example in the demo video the identified topic refers to a strike that happened in 2021 even though the model correctly identified that it lacked recent enough data to reply and therefore chose to do a web search ‚Äî which correctly provided information about the ongoing strike in 2023

## To Do

- [x] initial PoC
- [x] silly blog post
- refactor
  - [ ] nested Promises
  - [ ] unhandled empty responses (due to exceeded token length, network failure, etc.)
- features
  - [x] cite references
  - [ ] automatically trim history/prompts to fit token length
  - [ ] support more search engines such as DDG
  - [ ] image and video search
  - [ ] define more Agents
    - [ ] map Agents to topics to answer in different voices or further refine results
    - [ ] centralized service to create and 'train' own agents

---

This project was created using `bun init` in bun v0.5.7. [Bun](https://bun.sh) is a fast all-in-one JavaScript runtime.
